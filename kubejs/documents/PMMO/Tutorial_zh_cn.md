> 在Project MMO的2.0更新中，该模组对代码进行了重构。虽保留了核心机制，但实现细节和配置方式都发生了很大变化。本文将在Wiki翻译的基础上，结合深入研究和与原作者多次的交谈与查证，为大家提供详尽的魔改指导。

# Project MMO 2.0 更新指南

- [Project MMO 2.0 更新指南](#project-mmo-20-更新指南)
  - [文件结构](#文件结构)
    - [结构概览](#结构概览)
  - [经验](#经验)
  - [事件](#事件)
  - [技能](#技能)

## 文件结构
> 我的世界实例的文件结构应为: 启动器所在文件夹/.minecraft/version/游戏版本文件夹/或启动器所在文件夹/.minecraft/，该情况仅限于常见的启动器，如有其他启动器有不同的情况欢迎在评论中补充。

> 本教程所使用模组版本为pmmo-1.20.1-1.3.22。

- 文件结构的改动是对于玩家来说最直观的。
- 在2.0版本中，原本位于config/pmmo/文件夹中的配置被更改为了数据包与服务端配置文件；
- 其中一些较为基础的全局配置与客户端配置存储于config/pmmo-common.toml与config/pmmo-client.toml中。
- 其余的部分则存储于Serverconfig或需要使用数据包来定义。

### 结构概览

.minecraft/<br>
├── configs/<br>
│   ├── pmmo-client.toml **控制技能、经验获取、工具提示与连锁挖矿相关的显示。**<br>
│   └── pmmo-common.toml **调试用，通常该配置文件无需被使用。**<br>
└── saves/<br>
    └── world/ **你的存档名，通常你可以将此处的配置文件存于defaultconfigs/**<br>
        └── serverconfig/<br>
            ├── pmmo-AntiCheese.toml **反作弊相关设置，默认加入了未开启的钓鱼反作弊。**<br>
            ├── pmmo-AutoValues.toml **通过该文件的配置**<br>
            **可以自动根据物品、方块和实体的属性与为物品、方块和实体设置`使用需求`与`经验值获取`的值。**<br>
            **会被数据包覆盖。**<br>
            ├── pmmo-Globals.toml **当前用于简写数据包中NBT的Path**<br>
            **constants当前未实现任何功能。**<br>
            ├── pmmo-Perks.toml **控制玩家在提升等级时获取的收益以及等级为玩家带来的属性上的成长**<br>
            **可在此处禁用烟花火箭。**<br>
            ├── pmmo-Skills.toml **定义技能的最高等级与其显示的图标。**<br>
            └── pmmo-server.toml **所有该模组的核心配置都存放于此处**<br>
            **包括但不限于全局的经验获取速率、升级所需经验、经验获取的方式**<br>
            **以及各种`需求`的开关。**<br>

## 经验

- Project MMO的所有机制都与经验有关。通过游戏中的行为/事件可以获得经验，这些经验将在积累后使特定技能升级。
  特定技能的等级又被用作配置某些行为的`需求`。所有形式的`经验获取`和`需求`都是**可配置的**。
- 假设破坏一个石块会为玩家带来1点采矿经验。如果他们破坏了10个石块，他们将获得10点经验。
  现在假设使用石制镐需要采矿等级2。如果等级2需要20点经验，那么他们将需要再破坏10个石块才能使用石制镐。
- 有许多事件可以用来给玩家奖励经验，该部分内容将会在后文中补充。

## 事件

- 事件是PMMO监控的多种行为，会在游戏中为玩家提供不同技能的经验。
在所有情况下，玩家被授予的经验值都基于与该事件相关的物品、方块或实体的配置。
- 某些事件可以被阻止/妨碍或限制。有关`需求`的更多信息，请参见有关`需求`的教程。

**以下是PMMO中的所有事件：**

|事件名称|描述|需求|奖励|
|:---|:---:|:---:|:---:|
|**铁砧修复**|当玩家使用铁砧修复物品时|无|从物品的数据包配置中获取固定的经验值|
|**破坏方块**|当一个方块被破坏时（未将方块破坏的挖掘不会触发该事件）|`破坏`(方块)|由方块的数据包配置定义，受 `pmmo-server.toml` 中 `重复挖掘` 设置的影响，玩家挖掘自己放下的方块时减少获取的经验值|
|**破坏速度**|该事件被奖励系统用于控制方块被玩家破坏的速度，会在方块被破坏前检查需求|`工具`(物品) 和 `方块`(方块)|无|
|**放置方块**|当方块被玩家放置时|`放置`(方块)|由方块的数据包配置定义|
|**呼吸**|当玩家的氧气槽增加或减少时|无|在 `pmmo-server.toml` 中配置|
|**繁殖**|当动物被玩家喂食并因此繁殖出幼崽时|`繁殖`(实体)|从实体的数据包配置中获得固定的数值|
|**酿造**|当酿造台中酿造好的药水被玩家取出时|无|由物品的数据包配置定义（因配置输出物品，而非材料）|
|**消耗**|当药水或食物被玩家饮用或食用时|`食用`|从物品的数据包配置中获取固定的经验值|
|**制作**|当物品被制作时|无|从物品的数据包配置中获取固定的经验值|
|**蹲伏**|玩家每10刻的一次蹲伏（快速按下与松开Shift）|无|仅用于奖励系统|
|**受到伤害**|当玩家受到伤害时|无|根据造成伤害的实体来定义。如果是近战攻击，则为该实体；如果是远程攻击，则为投射物。如果该事件中无法获取到实体数据，可以在 `pmmo-server.toml` 中配置，来根据伤害类型来定义受伤时获取的经验类型/值。注意，该处的设置中，经验值根据伤害类型来区分，此处设置的数值会乘以玩家实际受到的伤害值（在护甲、附魔的减伤计算后）|
|**造成伤害**|当玩家造成近战伤害时|`武器`(物品) 和 `击杀`(实体)|结合玩家所持物品的数据包配置、受伤实体的数据包配置以及（或）投射物的数据。如果这三者都没有在数据包中进行伤害相关的配置，则使用 `pmmo-server.toml` 中的设置作为备用选项。玩家实际获取的经验值会乘以实际造成的伤害值（同样经过减伤效果后）|
|**死亡**|当实体因玩家而死亡时（注意，此时造成伤害和死亡的事件都会被触发，且可有不同的设置）|`武器`(物品) 和 `击杀`(实体)|在死亡实体的数据包配置中定义|
|**附魔**|当物品在附魔台上被附魔时|无|从物品的数据包中获取（配置的经验值会根据每个附魔的最大等级进行缩放。如果数据包中配置的值为100经验值且附魔的最高等级为1，那么等级1的附魔将给你100经验值。如果附魔的最高等级为3且你获得了等级1的附魔，你将获得33经验值。如果同时获得了这两个附魔，总共将获得133经验值）|
|**效果**|玩家在有任意激活中的药水效果时每10刻触发|无|在效果的数据包配置中定义|
|**钓鱼**|当玩家通过钓鱼获得物品时|`工具`(物品)|根据每个战利品物品的数据包配置，授予所有战利品物品的经验值总和|
|**熔炼**|当玩家在原版熔炉中熔炼物品时，将物品放置于熔炉的玩家获得经验值|无|从原材料的数据包配置中获取|
|**生长**|当作物的生长阶段增加一级时，放置作物的玩家获得经验值|无|从方块的数据包配置中获取|
|**生命值变化**|当玩家的生命值增加或减少时|无|在 `pmmo-server.toml` 中设置|
|**跳跃**|当玩家进行跳跃时|无|在 `pmmo-server.toml` 中定义|
|**冲刺加跳跃**|当玩家在冲刺时进行跳跃|无|在 `pmmo-server.toml` 中设置|
|**蹲伏加跳跃**|当玩家在蹲伏时进行跳跃|无|在 `pmmo-server.toml` 中设置|
|**左键方块**|当玩家左键方块时触发。与 `破坏速度` 事件类似，但不能修改破坏速度且在创造模式下该事件也会在玩家将方块破坏前被触发|`互动`(方块) 和 `互动`(物品)|从方块的数据包配置中获取|
|**激活方块**|当方块被玩家互动并因此被激活时（如按下按钮或拉下拉杆）|`互动`(方块) 和 `互动`(物品) 当持有物品与方块互动时|在方块的数据包配置来中定义该事件的行为，在物品的数据包配置中定义其在方块上使用的行为|
|**激活物品**|当物品被玩家右键点击（或激活）时|`使用`(物品)|从物品的数据包配置中获取|
|**交互**|当玩家与实体交互时触发，如剪羊毛或与村民交易|`实体互动`(实体)|从实体的数据包配置中获取|
|**骑乘**|玩家乘在任何交通工具（马、船、矿车等）上时，每10刻触发|无（但可以通过互动的检查来限制可提供骑乘经验的实体）|从实体的数据包配置中获取|
|**盾牌格挡**|成功用盾牌格挡伤害时获得经验|`武器`(物品)|在攻击实体的数据中定义|
|**技能升级**|每当玩家的等级增加时。这不是用来授予经验值，而是用于奖励系统|
|**冲刺**|玩家冲刺时，每10刻触发一次|无|在 `pmmo-server.toml` 中定义|
|**潜水**|玩家在水下时，每10刻触发一次，与其他适用的游泳事件同时触发|无|在 `pmmo-server.toml` 中配置|
|**游泳**|玩家水面上游泳时，每10刻触发一次|无|在 `pmmo-server.toml` 中配置并乘以移动速度|
|**潜水下沉**|玩家在水下并正在下沉时，每10刻触发一次|无|在 `pmmo-server.toml` 中配置并乘以移动速度|
|**浮出水面**|玩家在水下但上浮时，每10刻触发一次|无|在 `pmmo-server.toml` 中配置并乘以移动速度|
|**速泳**|玩家通过冲刺按键在水下速泳时，每10刻触发一次|无|在 `pmmo-server.toml` 中配置并乘以移动速度|
|**驯服**|成功驯服动物时触发|`驯服`(实体)|从被驯服实体的数据包配置中获取|

> 每20刻为一秒。

## 技能